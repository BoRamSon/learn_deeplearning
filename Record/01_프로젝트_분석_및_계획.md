# π© CNN-LSTM λ¨λΈ ν›λ ¨ ν”„λ΅μ νΈ λ¶„μ„ λ° κ³„ν

## π“‹ ν”„λ΅μ νΈ κ°μ”
- **λ©ν‘**: μ μ΅°μ—… μ•μ „μ‚¬κ³  μλ°©μ„ μ„ν• μ»΄ν“¨ν„° λΉ„μ „ λ¨λΈ κ°λ°
- **λ°μ΄ν„°μ…‹**: AIν—λΈ "μ¤λ§νΈ μ μ΅° μ‹μ„¤ μ•μ „ κ°μ‹λ¥Ό μ„ν• λ°μ΄ν„°"
- **λ¨λΈ**: CNN-LSTM (pranoyr/cnn-lstm μ €μ¥μ† ν™μ©)
- **κ°λ°ν™κ²½**: Windows, NVIDIA GeForce GTX 1650, Python 3.11, uv ν¨ν‚¤μ§€ κ΄€λ¦¬μ

## π” ν„μ¬ μƒν™© λ¶„μ„

### 1. ν”„λ΅μ νΈ ν΄λ” κµ¬μ΅°
```
human-accident/
β”β”€β”€ data/
β”‚   β””β”€β”€ safety-data/
β”‚       β””β”€β”€ human-accident/
β”‚           β”β”€β”€ bump/           # μ¶©λ μ‚¬κ³  λΉ„λ””μ¤ (136κ° νμΌ)
β”‚           β”β”€β”€ fall-down/      # λ„μ–΄μ§ μ‚¬κ³ 
β”‚           β”β”€β”€ fall-off/       # μ¶”λ½ μ‚¬κ³ 
β”‚           β”β”€β”€ hit/           # νƒ€κ²© μ‚¬κ³ 
β”‚           β”β”€β”€ jam/           # λΌμ„ μ‚¬κ³ 
β”‚           β””β”€β”€ no-accident/   # μ •μƒ μƒν™©
β”β”€β”€ cnn-lstm/                  # ν΄λ΅ λ λ¨λΈ μ €μ¥μ†
β”‚   β”β”€β”€ main.py               # λ©”μΈ ν›λ ¨ μ¤ν¬λ¦½νΈ
β”‚   β”β”€β”€ opts.py               # μ»¤λ§¨λ“λΌμΈ μµμ… μ •μ
β”‚   β”β”€β”€ models/cnnlstm.py     # CNN-LSTM λ¨λΈ μ•„ν‚¤ν…μ²
β”‚   β”β”€β”€ dataset.py            # λ°μ΄ν„°μ…‹ λ΅λ”
β”‚   β””β”€β”€ datasets/ucf101.py    # UCF101 λ°μ΄ν„°μ…‹ ν΄λμ¤
β””β”€β”€ 30_model_training.ipynb   # ν„μ¬ μ‘μ—… μ¤‘μΈ λ…ΈνΈλ¶
```

### 2. λ°μ΄ν„° ν•νƒ λ¶„μ„
- **ν„μ¬ λ°μ΄ν„°**: `.avi` λΉ„λ””μ¤ νμΌλ“¤μ΄ ν΄λμ¤λ³„ ν΄λ”μ— μ €μ¥
- **λ¨λΈ μ”κµ¬μ‚¬ν•­**: ν”„λ μ„ μ΄λ―Έμ§€λ“¤ (`image_00001.jpg`, `image_00002.jpg`, ...)
- **ν•„μ”ν• μ‘μ—…**: λΉ„λ””μ¤ β†’ ν”„λ μ„ μ΄λ―Έμ§€ λ³€ν™ λ° μ–΄λ…Έν…μ΄μ… νμΌ μƒμ„±

### 3. CNN-LSTM λ¨λΈ κµ¬μ΅° μ΄ν•΄
```python
class CNNLSTM(nn.Module):
    def __init__(self, num_classes=2):
        # ResNet-101 (μ‚¬μ „ν›λ ¨) β†’ 300μ°¨μ› νΉμ§• μ¶”μ¶
        self.resnet = resnet101(pretrained=True)
        self.resnet.fc = nn.Sequential(nn.Linear(self.resnet.fc.in_features, 300))
        
        # LSTM: 300 β†’ 256 (3 λ μ΄μ–΄)
        self.lstm = nn.LSTM(input_size=300, hidden_size=256, num_layers=3)
        
        # λ¶„λ¥κΈ°: 256 β†’ 128 β†’ num_classes
        self.fc1 = nn.Linear(256, 128)
        self.fc2 = nn.Linear(128, num_classes)
```

## π“ ν•΄κ²°ν•΄μ•Ό ν•  μ£Όμ” λ¬Έμ μ 

### 1. λ°μ΄ν„° ν•νƒ λ¶μΌμΉ
- **λ¬Έμ **: ν„μ¬ `.avi` λΉ„λ””μ¤ νμΌ, λ¨λΈμ€ ν”„λ μ„ μ΄λ―Έμ§€ κΈ°λ€
- **ν•΄κ²°λ°©μ•**: FFmpegλ¥Ό μ‚¬μ©ν• λΉ„λ””μ¤ β†’ ν”„λ μ„ λ³€ν™ μ¤ν¬λ¦½νΈ μ‘μ„±

### 2. μ–΄λ…Έν…μ΄μ… νμΌ λ¶€μ¬
- **λ¬Έμ **: UCF101 ν•μ‹μ JSON μ–΄λ…Έν…μ΄μ… νμΌ ν•„μ”
- **ν•΄κ²°λ°©μ•**: μ‚¬μ©μ λ°μ΄ν„°μ— λ§λ” μ–΄λ…Έν…μ΄μ… νμΌ μƒμ„±

### 3. ν΄λμ¤ μ λ¶μΌμΉ
- **λ¬Έμ **: λ¨λΈ κΈ°λ³Έκ°’ 400ν΄λμ¤, μ‚¬μ©μ λ°μ΄ν„°λ” 6ν΄λμ¤
- **ν•΄κ²°λ°©μ•**: `--n_classes 6` μµμ…μΌλ΅ μ„¤μ •

### 4. λ°μ΄ν„°μ…‹ λ΅λ” μμ • ν•„μ”
- **λ¬Έμ **: UCF101 μ „μ© λ°μ΄ν„°μ…‹ ν΄λμ¤
- **ν•΄κ²°λ°©μ•**: μ‚¬μ©μ λ°μ΄ν„°μ— λ§λ” μ»¤μ¤ν…€ λ°μ΄ν„°μ…‹ ν΄λμ¤ μ‘μ„±

## π― λ‹¨κ³„λ³„ μ‹¤ν–‰ κ³„ν

### Phase 1: λ°μ΄ν„° μ „μ²λ¦¬
1. λΉ„λ””μ¤ β†’ ν”„λ μ„ μ΄λ―Έμ§€ λ³€ν™ μ¤ν¬λ¦½νΈ μ‘μ„±
2. μ–΄λ…Έν…μ΄μ… JSON νμΌ μƒμ„±
3. λ°μ΄ν„°μ…‹ κµ¬μ΅° UCF101 ν•μ‹μΌλ΅ μ¬κµ¬μ„±

### Phase 2: λ¨λΈ μ„¤μ • μμ •
1. ν΄λμ¤ μλ¥Ό 6κ°λ΅ λ³€κ²½
2. μ»¤μ¤ν…€ λ°μ΄ν„°μ…‹ ν΄λμ¤ μ‘μ„±
3. ν›λ ¨/κ²€μ¦ λ°μ΄ν„° λ¶„ν•  μ„¤μ •

### Phase 3: ν›λ ¨ μ‹¤ν–‰
1. μ†κ·λ¨ ν…μ¤νΈ μ‹¤ν–‰ (λ°°μΉ ν¬κΈ° μ‘κ²)
2. ν•μ΄νΌνλΌλ―Έν„° μ΅°μ •
3. λ³Έκ²©μ μΈ ν›λ ¨ μ‹¤ν–‰

### Phase 4: λ¨λ‹ν„°λ§ λ° ν‰κ°€
1. TensorBoardλ΅ ν›λ ¨ κ³Όμ • λ¨λ‹ν„°λ§
2. μ²΄ν¬ν¬μΈνΈ μ €μ¥ λ° κ΄€λ¦¬
3. λ¨λΈ μ„±λ¥ ν‰κ°€

## π”§ ν•„μ”ν• λ„κµ¬ λ° λΌμ΄λΈλ¬λ¦¬
- FFmpeg (λΉ„λ””μ¤ ν”„λ μ„ μ¶”μ¶)
- OpenCV (μ΄λ―Έμ§€ μ²λ¦¬)
- PyTorch, torchvision (λ”¥λ¬λ‹)
- TensorBoard (ν›λ ¨ λ¨λ‹ν„°λ§)

## π“ μμƒ ν΄λμ¤ κµ¬μ„±
1. `bump` - μ¶©λ μ‚¬κ³ 
2. `fall-down` - λ„μ–΄μ§ μ‚¬κ³   
3. `fall-off` - μ¶”λ½ μ‚¬κ³ 
4. `hit` - νƒ€κ²© μ‚¬κ³ 
5. `jam` - λΌμ„ μ‚¬κ³ 
6. `no-accident` - μ •μƒ μƒν™©

---
**μ‘μ„±μΌ**: 2025-09-16  
**λ‹¤μ λ‹¨κ³„**: λΉ„λ””μ¤ β†’ ν”„λ μ„ λ³€ν™ μ¤ν¬λ¦½νΈ μ‘μ„±
